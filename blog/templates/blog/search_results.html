{% extends 'blog/base.html' %}

{% block content %}
    <div class="search-page">
        <h2>Search Posts</h2>
        
        <!-- Search Form -->
        <form method="get" class="search-form">
            {{ form.query }}
            <button type="submit" class="btn btn-secondary">Search</button>
            <a href="{% url 'post_list' %}" class="btn btn-clear">Back to All Posts</a>
        </form>

        {% if query %}
            <div class="search-results">
                <h3>Search Results for "{{ query }}"</h3>
                <p class="results-count">{{ posts.count }} post{{ posts.count|pluralize }} found</p>
                
                {% for post in posts %}
                    <article class="post">
                        <time class="date">
                            {{ post.published_date }}
                        </time>
                        <h4><a href="{% url 'post_detail' pk=post.pk %}">{{ post.title }}</a></h4>
                        <p>{{ post.text|truncatewords:30|linebreaksbr }}</p>
                        
                        <!-- Post Meta -->
                        <div class="post-meta">
                            <span class="post-stats">
                                üí¨ {{ post.get_comment_count }} ‚Ä¢ ‚ù§Ô∏è {{ post.get_like_count }}
                            </span>
                            {% if post.tags.all %}
                                <div class="post-tags">
                                    {% for tag in post.tags.all %}
                                        <span class="tag-mini">{{ tag.name }}</span>
                                    {% endfor %}
                                </div>
                            {% endif %}
                        </div>
                    </article>
                {% empty %}
                    <div class="no-results">
                        <p>No posts found matching "{{ query }}".</p>
                        <p>Try a different search term or <a href="{% url 'post_list' %}">browse all posts</a>.</p>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <p>Enter a search term to find posts.</p>
        {% endif %}
    </div>
{% endblock %}